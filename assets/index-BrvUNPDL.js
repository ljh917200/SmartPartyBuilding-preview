import{h as Y,r as f,D as y,G as Z,B as n,c as ee,a as t,w as o,b as s,o as I,g as c,f as te,s as le,M as ae,k,j as oe,z as re,_ as ne}from"./index-G-qDTFo-.js";const ie={class:"container"},se={class:"table-wrapper"},de=Y({__name:"index",setup(ue){const h=f([]),B=f(0),b=f(!1),m=y({pageNum:1,pageSize:10}),p=y({id:"",describe:""}),g=f(!1),_=f(null),a=y({id:"",describe:"",url:""}),w=y({id:"",describe:"",url:""}),M=f(!1),z=y({describe:[{required:!0,message:"请输入权限描述",trigger:"blur"}],url:[{required:!0,message:"请输入权限URL",trigger:"blur"}]}),C=f([]),E=async l=>{if(!l){i();return}b.value=!0;try{const e={code:1,msg:"sucess",data:{id:"PERM_001",describe:"用户管理",url:"/user/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"}};e.code===1&&(h.value=[e.data],B.value=1)}catch(e){n.error("查询权限出错"),console.error("查询权限出错:",e),await i()}finally{b.value=!1}},A=()=>{m.pageNum=1,p.id?E(p.id):i()},P=()=>{Object.assign(p,{id:"",describe:""}),m.pageNum=1,i()},F=l=>{m.pageNum=l,i()},S=l=>{m.pageSize=l,m.pageNum=1,i()},U=l=>{N(),Object.assign(w,{id:l.id,describe:l.describe,url:l.url}),Object.assign(a,{id:l.id,describe:l.describe,url:l.url}),g.value=!0},j=()=>{N(),Object.assign(w,{id:"",describe:"",url:""}),Object.assign(a,{id:"",describe:"",url:""}),g.value=!0},L=()=>!a.describe.trim()||!a.url.trim(),V=()=>a.describe!==w.describe||a.url!==w.url,x=()=>{M.value=V()},O=async()=>{try{if(_.value&&await _.value.validate(),L()){n.warning("请填写完整的权限信息");return}if(a.id&&!V()){n.warning("请先修改权限内容");return}({code:1,msg:"sucess",data:null}).code===1&&(n.success(a.id?"更新成功":"新增成功"),g.value=!1,await i())}catch(l){n.error(a.id?"更新出错":"新增出错"),console.error(a.id?"更新权限出错:":"新增权限出错:",l)}},N=()=>{_.value&&_.value.resetFields(),M.value=!1},$=async l=>{try{({code:1,msg:"sucess",data:null}).code===1&&(n.success("删除成功"),await i())}catch(e){n.error("删除出错"),console.error("删除权限出错:",e)}},q=async()=>{if(C.value.length===0){n.warning("请选择要删除的权限");return}if(await re.confirm(`确定要删除选中的${C.value.length}个权限吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>!1)==="confirm")try{({code:1,msg:"sucess",data:null}).code===1&&(n.success("批量删除成功"),C.value=[],await i())}catch(e){n.error("批量删除出错"),console.error("批量删除权限出错:",e)}},G=l=>{C.value=l.map(e=>e.id)};Z(()=>{i()});const i=async()=>{b.value=!0;try{const l={code:1,msg:"sucess",data:{total:5,records:[{id:"PERM_001",describe:"用户管理",url:"/user/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"},{id:"PERM_002",describe:"资料管理",url:"/datas/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"},{id:"PERM_003",describe:"考试管理",url:"/examination/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"},{id:"PERM_004",describe:"活动管理",url:"/action/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"},{id:"PERM_005",describe:"签到管理",url:"/sign/manage",createBy:"ADMIN",createTime:"2025-05-25 17:15:53",updateBy:"ADMIN",updateTime:"2025-05-25 17:15:53"}]}};l.code===1&&(h.value=l.data.records,B.value=l.data.total)}catch(l){n.error("获取权限列表出错"),console.error("获取权限列表出错:",l)}finally{b.value=!1}};return(l,e)=>{const D=s("el-input"),v=s("el-form-item"),d=s("el-button"),R=s("el-form"),T=s("el-card"),u=s("el-table-column"),H=s("el-popconfirm"),J=s("el-table"),K=s("el-pagination"),Q=s("el-dialog"),W=ae("loading");return I(),ee("div",ie,[t(T,null,{default:o(()=>[t(R,{inline:!0,class:"form",model:p},{default:o(()=>[t(v,{label:"权限ID:"},{default:o(()=>[t(D,{modelValue:p.id,"onUpdate:modelValue":e[0]||(e[0]=r=>p.id=r),placeholder:"请输入权限ID查询"},null,8,["modelValue"])]),_:1}),t(v,null,{default:o(()=>[t(d,{type:"primary",icon:"Search",size:"default",onClick:A,disabled:!p.id.trim()},{default:o(()=>[...e[7]||(e[7]=[c("搜索",-1)])]),_:1},8,["disabled"]),t(d,{size:"default",icon:"Refresh",onClick:P},{default:o(()=>[...e[8]||(e[8]=[c("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(T,{style:{margin:"10px 0"}},{default:o(()=>[t(d,{type:"primary",size:"default",icon:"Plus",onClick:e[1]||(e[1]=r=>j())},{default:o(()=>[...e[9]||(e[9]=[c("添加权限",-1)])]),_:1}),t(d,{type:"danger",size:"default",icon:"Delete",onClick:q},{default:o(()=>[...e[10]||(e[10]=[c("批量删除",-1)])]),_:1}),te("div",se,[le((I(),k(J,{border:"",data:h.value,onSelectionChange:G,width:"100%",fit:""},{default:o(()=>[t(u,{type:"selection",align:"center",fixed:"left"}),t(u,{label:"#",align:"center",type:"index",fixed:"left"}),t(u,{label:"权限描述",align:"center",prop:"describe","show-overflow-tooltip":""}),t(u,{label:"权限URL",align:"center",prop:"url","show-overflow-tooltip":""}),t(u,{label:"创建人",align:"center",prop:"createBy","show-overflow-tooltip":""}),t(u,{label:"创建时间",align:"center",prop:"createTime","show-overflow-tooltip":""}),t(u,{label:"更新时间",align:"center",prop:"updateTime","show-overflow-tooltip":""}),t(u,{label:"操作",width:"180",align:"center",fixed:"right"},{default:o(({row:r})=>[t(d,{type:"primary",size:"small",plain:"",icon:"Edit",onClick:X=>U(r)},{default:o(()=>[...e[11]||(e[11]=[c("编辑",-1)])]),_:1},8,["onClick"]),t(H,{title:"确定要删除该权限吗?",onConfirm:X=>$(r.id),width:"260px"},{reference:o(()=>[t(d,{type:"danger",plain:"",size:"small",icon:"Delete"},{default:o(()=>[...e[12]||(e[12]=[c("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,b.value]])]),t(K,{"page-sizes":[5,10,20,50],"page-size":m.pageSize,"current-page":m.pageNum,total:B.value,background:!0,layout:" prev, pager, next, jumper,->,sizes,total",onCurrentChange:F,onSizeChange:S},null,8,["page-size","current-page","total"])]),_:1}),t(Q,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=r=>g.value=r),title:a.id?"编辑权限":"添加权限",width:"30%",onClose:N},{footer:o(()=>[t(d,{onClick:e[5]||(e[5]=r=>g.value=!1)},{default:o(()=>[...e[13]||(e[13]=[c("取消",-1)])]),_:1}),t(d,{type:"primary",onClick:O,disabled:a.id&&!M.value||!a.describe.trim()||!a.url.trim()},{default:o(()=>[...e[14]||(e[14]=[c(" 保存 ",-1)])]),_:1},8,["disabled"])]),default:o(()=>[t(R,{model:a,rules:z,ref_key:"editFormRef",ref:_,"label-width":"80px"},{default:o(()=>[a.id?(I(),k(v,{key:0,label:"权限ID"},{default:o(()=>[t(D,{modelValue:a.id,"onUpdate:modelValue":e[2]||(e[2]=r=>a.id=r),disabled:""},null,8,["modelValue"])]),_:1})):oe("",!0),t(v,{label:"权限描述",prop:"describe"},{default:o(()=>[t(D,{modelValue:a.describe,"onUpdate:modelValue":e[3]||(e[3]=r=>a.describe=r),placeholder:"请输入权限描述",onInput:x},null,8,["modelValue"])]),_:1}),t(v,{label:"权限URL",prop:"url"},{default:o(()=>[t(D,{modelValue:a.url,"onUpdate:modelValue":e[4]||(e[4]=r=>a.url=r),placeholder:"请输入权限URL",onInput:x},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),me=ne(de,[["__scopeId","data-v-86708181"]]);export{me as default};
