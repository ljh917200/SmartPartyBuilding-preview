import{h as A,D as R,r,ag as w,G as K,c as h,f as t,a as l,s as Q,w as o,p as a,H as W,$ as g,M as X,k as Z,ah as ee,ai as te,a2 as N,B as p,o as B,g as v,aj as f,a6 as ae,a7 as C,a8 as M,ak as P,j as le,t as c,z as se,_ as ie}from"./index-G-qDTFo-.js";const ne={class:"signin-container"},oe={class:"table-wrapper"},de={class:"button-container"},re={class:"pagination-wrapper"},ue={key:0,class:"detail-content"},pe={class:"detail-item"},me={class:"detail-value"},ce={class:"detail-item"},ge={class:"detail-value"},ve={class:"detail-item"},fe={class:"detail-value"},Te={class:"detail-item"},ye={class:"detail-value"},_e={class:"detail-item"},Ie={class:"detail-value"},Ce={class:"detail-item"},be={class:"detail-value"},De={class:"detail-item"},Se={class:"detail-value"},Ve={class:"detail-item"},Ee={class:"detail-value"},we={class:"detail-item"},Be={class:"detail-value"},ke=A({__name:"index",setup(xe){const m=R({currentPage:1,pageSize:10,total:0}),b=r([]),T=r(!1),y=async()=>{T.value=!0;try{const i={code:1,msg:"sucess",data:{total:5,records:[{id:"SIGN_001",signInTitle:"红色观影活动签到",signInContent:"请在此处签到",startTime:"2023-10-05 13:30:00",endTime:"2023-10-05 14:30:00",createBy:"USER_003",createTime:"2025-05-25 17:19:00",updateBy:"USER_003",updateTime:"2025-05-25 17:19:00",isDelete:2},{id:"SIGN_002",signInTitle:"志愿者活动签到",signInContent:"社区服务签到",startTime:"2023-10-15 08:00:00",endTime:"2023-10-15 09:00:00",createBy:"USER_003",createTime:"2025-05-25 17:19:00",updateBy:"USER_003",updateTime:"2025-05-25 17:19:00",isDelete:2},{id:"SIGN_003",signInTitle:"党史知识竞赛签到",signInContent:"竞赛开始前签到",startTime:"2023-10-25 09:30:00",endTime:"2023-10-25 10:30:00",createBy:"USER_003",createTime:"2025-05-25 17:19:00",updateBy:"USER_003",updateTime:"2025-05-25 17:19:00",isDelete:2},{id:"SIGN_004",signInTitle:"烈士陵园扫墓签到",signInContent:"集体活动签到",startTime:"2023-11-05 09:00:00",endTime:"2023-11-05 10:00:00",createBy:"USER_003",createTime:"2025-05-25 17:19:00",updateBy:"USER_003",updateTime:"2025-05-25 17:19:00",isDelete:2},{id:"SIGN_005",signInTitle:"党员发展大会签到",signInContent:"正式会议签到",startTime:"2023-11-15 13:30:00",endTime:"2023-11-15 14:30:00",createBy:"USER_003",createTime:"2025-05-25 17:19:00",updateBy:"USER_003",updateTime:"2025-05-25 17:19:00",isDelete:2}]}};i.code===1&&(b.value=i.data.records,m.total=i.data.total)}catch(i){console.error("获取签到列表失败",i),p.error("获取签到列表失败，请稍后重试")}finally{T.value=!1}},Y=async i=>{try{({code:1,msg:null,data:null}).code==1&&(p.success("删除成功"),await y())}catch{p.error("删除失败，请稍后重试")}},F=async i=>{try{await se.confirm("确定要删除该签到吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Y(i.id)}catch{}},G=i=>{m.currentPage=i,y()},$=i=>{m.pageSize=i,m.currentPage=1,y()},s=R({signInTitle:"",signInContent:null,startTime:"",endTime:""}),D=r(w(s)),_=r(!1),k=r("添加签到"),S=r("add"),H=r(""),V=r(),I=r(!1),x=r(!1),d=r(null),j=async(i,e=!0)=>{x.value=!0;try{const u=b.value.find(n=>n.id===i);return u?(e&&(d.value=u,I.value=!0),u):(p.error("获取详情失败，未找到对应签到"),null)}catch(u){return p.error("获取详情失败，请稍后重试"),console.error("获取签到详情失败",u),null}finally{x.value=!1}},O=()=>{I.value=!1,d.value=null},U=async(i="add",e)=>{S.value=i,k.value=i==="add"?"添加签到":"编辑签到",V.value&&V.value.clearValidate(),i==="add"?(Object.keys(s).forEach(u=>{u!=="id"&&(s[u]="")}),s.signInContent=null,delete s.id,D.value=w(s),_.value=!0):e&&(H.value=e.id,s.id=e.id,s.signInTitle=e.signInTitle,s.signInContent=e.signInContent,s.startTime=e.startTime,s.endTime=e.endTime,D.value=w(s),_.value=!0)},E=()=>{_.value=!1},J=()=>{const i=[{key:"signInTitle",name:"签到标题"}];for(const e of i)if(!s[e.key])return p.warning(`${e.name}不能为空`),!1;return!0},q=()=>JSON.stringify(s)!==JSON.stringify(D.value),L=async()=>{if(J()){if(S.value==="edit"&&!q()){p.warning("未做任何修改，无需提交");return}T.value=!0;try{S.value==="add"?p.success("添加成功"):p.success("修改成功"),E(),await y()}catch{p.error("操作失败，请稍后重试")}finally{T.value=!1}}};return K(()=>{y()}),(i,e)=>{const u=X("loading");return B(),h("div",ne,[t("div",oe,[t("div",de,[l(a(g),{type:"primary",icon:a(W),size:"default",onClick:e[0]||(e[0]=n=>U("add"))},{default:o(()=>[...e[9]||(e[9]=[v(" 添加签到 ",-1)])]),_:1},8,["icon"])]),Q((B(),Z(a(ee),{data:b.value,style:{width:"100%"},fit:"",size:"default",stripe:"",border:""},{default:o(()=>[l(a(f),{prop:"signInTitle",label:"签到标题",fixed:"left","show-overflow-tooltip":""}),l(a(f),{prop:"signInContent",label:"签到内容","show-overflow-tooltip":""}),l(a(f),{prop:"startTime",label:"开始时间","show-overflow-tooltip":""}),l(a(f),{prop:"endTime",label:"结束时间","show-overflow-tooltip":""}),l(a(f),{prop:"createTime",label:"创建时间","show-overflow-tooltip":""}),l(a(f),{label:"操作",width:"280",fixed:"right"},{default:o(({row:n})=>[l(a(g),{type:"primary",plain:"",size:"small",icon:"Edit",onClick:z=>U("edit",n),style:{"margin-right":"8px"}},{default:o(()=>[...e[10]||(e[10]=[v("编辑",-1)])]),_:1},8,["onClick"]),l(a(g),{type:"success",plain:"",size:"small",icon:"View",onClick:z=>j(n.id),style:{"margin-right":"8px"}},{default:o(()=>[...e[11]||(e[11]=[v("详情",-1)])]),_:1},8,["onClick"]),l(a(g),{type:"danger",plain:"",size:"small",icon:"Delete",onClick:z=>F(n)},{default:o(()=>[...e[12]||(e[12]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[u,T.value]]),t("div",re,[l(a(te),{"current-page":m.currentPage,"onUpdate:currentPage":e[1]||(e[1]=n=>m.currentPage=n),"page-size":m.pageSize,"onUpdate:pageSize":e[2]||(e[2]=n=>m.pageSize=n),"page-sizes":[10,20,50,100],layout:"prev, pager, next, jumper,->,sizes, total",background:!0,total:m.total,onSizeChange:$,onCurrentChange:G},null,8,["current-page","page-size","total"])])]),l(a(N),{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=n=>_.value=n),title:k.value,width:"600px",onClose:E},{footer:o(()=>[l(a(g),{onClick:E},{default:o(()=>[...e[13]||(e[13]=[v("取消",-1)])]),_:1}),l(a(g),{type:"primary",onClick:L},{default:o(()=>[...e[14]||(e[14]=[v("确定",-1)])]),_:1})]),default:o(()=>[l(a(ae),{ref_key:"formRef",ref:V,model:s,"label-width":"120px"},{default:o(()=>[l(a(C),{label:"签到标题"},{default:o(()=>[l(a(M),{modelValue:s.signInTitle,"onUpdate:modelValue":e[3]||(e[3]=n=>s.signInTitle=n),placeholder:"请输入签到标题"},null,8,["modelValue"])]),_:1}),l(a(C),{label:"签到内容"},{default:o(()=>[l(a(M),{modelValue:s.signInContent,"onUpdate:modelValue":e[4]||(e[4]=n=>s.signInContent=n),type:"textarea",placeholder:"请输入签到内容",rows:4},null,8,["modelValue"])]),_:1}),l(a(C),{label:"开始时间"},{default:o(()=>[l(a(P),{modelValue:s.startTime,"onUpdate:modelValue":e[5]||(e[5]=n=>s.startTime=n),type:"datetime",placeholder:"选择开始时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(a(C),{label:"结束时间"},{default:o(()=>[l(a(P),{modelValue:s.endTime,"onUpdate:modelValue":e[6]||(e[6]=n=>s.endTime=n),type:"datetime",placeholder:"选择结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(a(N),{modelValue:I.value,"onUpdate:modelValue":e[8]||(e[8]=n=>I.value=n),title:"签到详情",width:"700px",onClose:O},{default:o(()=>[d.value?(B(),h("div",ue,[t("div",pe,[e[15]||(e[15]=t("span",{class:"detail-label"},"签到ID：",-1)),t("span",me,c(d.value.id),1)]),t("div",ce,[e[16]||(e[16]=t("span",{class:"detail-label"},"签到标题：",-1)),t("span",ge,c(d.value.signInTitle),1)]),t("div",ve,[e[17]||(e[17]=t("span",{class:"detail-label"},"签到内容：",-1)),t("span",fe,c(d.value.signInContent||"-"),1)]),t("div",Te,[e[18]||(e[18]=t("span",{class:"detail-label"},"开始时间：",-1)),t("span",ye,c(d.value.startTime),1)]),t("div",_e,[e[19]||(e[19]=t("span",{class:"detail-label"},"结束时间：",-1)),t("span",Ie,c(d.value.endTime),1)]),t("div",Ce,[e[20]||(e[20]=t("span",{class:"detail-label"},"创建人：",-1)),t("span",be,c(d.value.createBy),1)]),t("div",De,[e[21]||(e[21]=t("span",{class:"detail-label"},"创建时间：",-1)),t("span",Se,c(d.value.createTime),1)]),t("div",Ve,[e[22]||(e[22]=t("span",{class:"detail-label"},"更新人：",-1)),t("span",Ee,c(d.value.updateBy),1)]),t("div",we,[e[23]||(e[23]=t("span",{class:"detail-label"},"更新时间：",-1)),t("span",Be,c(d.value.updateTime),1)])])):le("",!0)]),_:1},8,["modelValue"])])}}}),ze=ie(ke,[["__scopeId","data-v-cce0739a"]]);export{ze as default};
