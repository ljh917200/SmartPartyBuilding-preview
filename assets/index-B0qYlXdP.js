import{h as xe,r as f,D as A,Z as De,G as ze,c as v,a as l,w as a,b as m,B as c,o as r,g as p,f as k,t as h,j as z,k as b,F as L,i as F,s as Ne,M as Se,z as te,_ as Pe}from"./index-BxqgcJHC.js";const Ue={class:"container"},Me={style:{display:"flex","justify-content":"flex-start","align-items":"center","margin-bottom":"10px"}},Be={class:"table-wrapper"},Le={class:"question-content"},Ee={class:"pagination-container"},Re=["innerHTML"],$e={key:0},je=["innerHTML"],Ae={key:1},Fe={key:0},He={key:1},Je={key:2},Ie={key:2},Ke={key:0},Qe={key:3},Ge=xe({__name:"index",setup(Ze){const V=f(!1),E=f("添加题目"),R=f(!1),H=f({}),P=f(!1),$=f(!1),d=f({}),o=A({id:"",type:"",question:"",questionOption:"",answerType:""}),w=f([{id:1,value:""}]);let U=2;const g=f([{id:1,value:""}]);let M=2;const O=f(),le=A({question:[{required:!0,message:"请输入问题内容",trigger:"blur"}],type:[{required:!0,message:"请选择题目类型",trigger:"change"}],questionOption:[{required:!0,message:"请输入选择题选项",trigger:"blur"}],answerType:[{required:!0,message:"请输入答案",trigger:"blur"}]}),ae=t=>JSON.parse(JSON.stringify(t)),oe=t=>{w.value=[{id:1,value:""}],g.value=[{id:1,value:""}],o.questionOption="",o.answerType="",t==="3"&&(o.answerType="1")},ne=()=>{w.value.push({id:U++,value:""})},ie=t=>{w.value.length>1&&(w.value=w.value.filter(e=>e.id!==t))},se=()=>{g.value.push({id:M++,value:""})},ue=t=>{g.value.length>1&&(g.value=g.value.filter(e=>e.id!==t))},y=A({currentPage:1,pageSize:10,total:0}),J=f([]),I=f(!1),N=f([]),C=f(""),K=De(()=>C.value.trim().length>0),q=async()=>{I.value=!0;try{const t=[{id:"1",type:"4",question:"中国共产党的性质和宗旨是什么？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"2",type:"1",question:"党的最高理想和最终目标是什么？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"3",type:"2",question:"以下哪些是党员的义务？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"4",type:"2",question:"党的纪律处分有哪些？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"5",type:"3",question:"预备党员没有表决权、选举权和被选举权。",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"6",type:"1",question:"中国共产党的宗旨是什么？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"7",type:"2",question:"中国共产党的行动指南包括哪些理论？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"8",type:"3",question:"党的基层组织是党在社会基层组织中的战斗堡垒。",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"9",type:"1",question:"党员的党龄从何时开始计算？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"10",type:"2",question:"党的民主集中制的基本原则包括哪些？",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"11",type:"3",question:"党员必须维护党的团结和统一。",isChoose:1,updateTime:"2025-05-25 17:24:54"},{id:"12",type:"4",question:"党的三大作风是什么？",isChoose:1,updateTime:"2025-05-25 17:24:54"}];await new Promise(s=>setTimeout(s,500));let e=t;if(C.value.trim()){const s=C.value.trim().toLowerCase();e=t.filter(T=>T.question.toLowerCase().includes(s)),e.length===0&&c.info(`未找到包含"${C.value.trim()}"的题目`)}let i=e;if(!C.value.trim()){const s=(y.currentPage-1)*y.pageSize,T=s+y.pageSize;i=t.slice(s,T)}const u={code:1,msg:"success",data:{total:C.value.trim()?e.length:t.length,records:i}};u.code==1&&(J.value=u.data.records,y.total=u.data.total)}catch(t){console.error("获取题库列表失败",t),c.error("获取数据失败，请稍后重试")}finally{I.value=!1}},re=t=>{y.currentPage=t,q()},de=t=>{y.pageSize=t,y.currentPage=1,q()},pe=()=>{K.value&&(y.currentPage=1,q())},ce=()=>{C.value="",y.currentPage=1,q()},Q=t=>({1:"单选题",2:"多选题",3:"判断题",4:"填空题"})[t]||"未知类型",me=t=>t===1?"是":"否",ye=()=>{R.value=!1,E.value="添加题目",Object.keys(o).forEach(t=>{o[t]=""}),w.value=[{id:1,value:""}],g.value=[{id:1,value:""}],U=2,M=2,o.type="1",o.answerType="",O.value&&O.value.clearValidate(),setTimeout(()=>{V.value=!0},0)},fe=async t=>{R.value=!0,E.value="编辑题目",o.id=t.id||"",console.log(t.id),console.log(t);try{const e=t.id||"1";let i=await G(e);if(o.type=i.type,o.question=i.question,o.questionOption=i.questionOption||"",o.answerType=i.answerType,(i.type==="1"||i.type==="2")&&i.questionOption){const u=i.questionOption.split(`
`);w.value=u.map((s,T)=>({id:T+1,value:s})),U=u.length+1}else w.value=[{id:1,value:""}],U=2;if(i.type==="4"&&i.answerType){const u=i.answerType.split(`
`);g.value=u.map((s,T)=>({id:T+1,value:s})),M=u.length+1}else g.value=[{id:1,value:""}],M=2;i.type==="3"&&(o.answerType=i.answerType||"1"),H.value=ae(o),O.value&&O.value.clearValidate(),setTimeout(()=>{V.value=!0},0)}catch{c.error("获取题目详情失败，请稍后重试")}},G=async t=>{try{await new Promise(i=>setTimeout(i,500));const e={code:1,msg:"success",data:{type:"1",question:"中国共产党成立于哪一年？",questionOption:`1.1921年
2.1922年
3.1923年
4.1924年`,answerType:"4",isChoose:1,updateName:"王五",updateTime:"2025-05-25 17:24:54"}};if(t==="fill_blank_sample"&&(e.data={type:"4",question:"请填写中国共产党的宗旨和性质。",questionOption:"",answerType:`中国共产党是中国工人阶级的先锋队，同时是中国人民和中华民族的先锋队。
以全心全意为人民服务为根本宗旨。`,isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),t==="true_false_sample"&&(e.data={type:"3",question:"中国共产党是中国工人阶级的先锋队。",questionOption:"",answerType:"1",isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),t==="fill_blank_detail_sample"&&(e.data={type:"4",question:"中国共产党的性质和宗旨是什么？",questionOption:"",answerType:`中国共产党是中国工人阶级的先锋队
同时是中国人民和中华民族的先锋队
以全心全意为人民服务为根本宗旨`,isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),t==="true_false_detail_sample"&&(e.data={type:"3",question:"党的最高理想和最终目标是实现共产主义。",questionOption:"",answerType:"2",isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),t==="fill_blank_edit_sample"&&(e.data={type:"4",question:"简述党的思想路线。",questionOption:"",answerType:`一切从实际出发
理论联系实际
实事求是
在实践中检验真理和发展真理`,isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),t==="true_false_edit_sample"&&(e.data={type:"3",question:"中国共产党始终代表中国先进生产力的发展要求。",questionOption:"",answerType:"1",isChoose:0,updateName:"王五",updateTime:"2025-05-25 17:24:54"}),e.code==1)return e.data;throw new Error("获取题目详情失败")}catch(e){throw console.error("获取题目详情失败",e),e}},ve=async t=>{$.value=!0;try{console.log(t.id);let i=t.id||"1";t.type==="4"?i="fill_blank_detail_sample":t.type==="3"&&(i="true_false_detail_sample");const u=await G(i);d.value=u,P.value=!0}catch{c.error("获取题目详情失败，请稍后重试")}finally{$.value=!1}},Z=()=>{P.value=!1},W=()=>{V.value=!1,O.value&&O.value.clearValidate()},ge=()=>JSON.stringify(o)!==JSON.stringify(H.value),_e=async()=>{if(!o.question.trim()){c.warning("请输入问题内容");return}if(!o.type){c.warning("请选择题目类型");return}if(o.type==="1"||o.type==="2"){const t=w.value.filter(e=>e.value.trim()!=="");if(t.length===0){c.warning("请至少输入一个选项");return}if(o.questionOption=t.map(e=>e.value).join(`
`),!o.answerType.trim()){c.warning("请输入答案");return}}else if(o.type==="4"){const t=g.value.filter(e=>e.value.trim()!=="");if(t.length===0){c.warning("请至少输入一个答案");return}o.answerType=t.map(e=>e.value).join(`
`)}else if(o.type==="3"&&!o.answerType){c.warning("请选择答案");return}try{if(R.value){if(!ge()){c.warning("未检测到任何修改");return}const t={code:1,msg:"更新成功",data:null};t.code==1&&(c.success(t.msg),V.value=!1,await q())}else{await new Promise(e=>setTimeout(e,500));const t={code:1,msg:"添加成功",data:null};t.code==1&&(c.success(t.msg),V.value=!1,await q())}}catch(t){console.error("提交表单失败",t),c.error("操作失败，请稍后重试")}},X=async t=>{try{const e=Array.isArray(t)?t.join(","):t;console.log(e),await new Promise(u=>setTimeout(u,500));const i={code:null,msg:null,data:null};c.success("删除成功"),await q(),N.value=[]}catch(e){console.error("删除题目失败",e),c.error("删除失败，请稍后重试")}},we=t=>{te.confirm(`确定要删除题目"${t.question}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{X(t.id||"")}).catch(()=>{})},Te=()=>{if(N.value.length===0){c.warning("请先选择要删除的题目");return}te.confirm(`确定要删除选中的${N.value.length}道题目吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=N.value.map(e=>e.id||"").filter(e=>e);X(t)}).catch(()=>{})},he=t=>{N.value=t};return ze(()=>{q()}),(t,e)=>{const i=m("el-input"),u=m("el-form-item"),s=m("el-button"),T=m("el-form"),j=m("el-card"),x=m("el-table-column"),be=m("el-table"),Ce=m("el-pagination"),B=m("el-option"),qe=m("el-select"),Y=m("el-radio"),ke=m("el-radio-group"),ee=m("el-dialog"),D=m("el-descriptions-item"),Ve=m("el-descriptions"),Oe=Se("loading");return r(),v("div",Ue,[l(j,null,{default:a(()=>[l(T,{inline:!0,class:"form"},{default:a(()=>[l(u,{label:"题目内容"},{default:a(()=>[l(i,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=n=>C.value=n),placeholder:"请输入题目内容",clearable:""},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(s,{type:"primary",size:"default",icon:"Search",disabled:!K.value,onClick:pe},{default:a(()=>[...e[10]||(e[10]=[p("搜索",-1)])]),_:1},8,["disabled"]),l(s,{size:"default",icon:"Refresh",onClick:ce},{default:a(()=>[...e[11]||(e[11]=[p("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),l(j,{style:{"margin-top":"10px"}},{default:a(()=>[k("div",Me,[l(s,{type:"primary",size:"default",icon:"Plus",style:{"margin-right":"10px"},onClick:ye},{default:a(()=>[...e[12]||(e[12]=[p("添加题目",-1)])]),_:1}),l(s,{type:"danger",size:"default",icon:"Delete",onClick:Te},{default:a(()=>[...e[13]||(e[13]=[p("批量删除",-1)])]),_:1})]),k("div",Be,[l(be,{border:"",style:{width:"100%"},data:J.value,"empty-text":"暂无数据",fit:"",onSelectionChange:he},{default:a(()=>[l(x,{type:"selection",align:"center",width:"80",fixed:"left"}),l(x,{type:"index",align:"center",label:"序号",width:"80",fixed:"left"}),l(x,{label:"题目类型",align:"center","show-overflow-tooltip":""},{default:a(({row:n})=>[p(h(Q(n.type)),1)]),_:1}),l(x,{prop:"question",label:"题目内容","show-overflow-tooltip":""},{default:a(({row:n})=>[k("div",Le,h(n.question),1)]),_:1}),l(x,{label:"是否被选用",align:"center","show-overflow-tooltip":""},{default:a(({row:n})=>[p(h(me(n.isChoose)),1)]),_:1}),l(x,{prop:"updateTime",label:"更新时间",align:"center","show-overflow-tooltip":""}),l(x,{label:"操作",width:"270",align:"center",fixed:"right","show-overflow-tooltip":""},{default:a(({row:n})=>[l(s,{type:"primary",size:"small",plain:"",icon:"Edit",style:{"margin-right":"5px"},onClick:_=>fe(n)},{default:a(()=>[...e[14]||(e[14]=[p("编辑",-1)])]),_:1},8,["onClick"]),l(s,{type:"success",size:"small",plain:"",icon:"Document",style:{"margin-right":"5px"},onClick:_=>ve(n)},{default:a(()=>[...e[15]||(e[15]=[p("详情",-1)])]),_:1},8,["onClick"]),l(s,{type:"danger",size:"small",plain:"",icon:"Delete",onClick:_=>we(n)},{default:a(()=>[...e[16]||(e[16]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),k("div",Ee,[l(Ce,{"current-page":y.currentPage,"onUpdate:currentPage":e[1]||(e[1]=n=>y.currentPage=n),"page-size":y.pageSize,"onUpdate:pageSize":e[2]||(e[2]=n=>y.pageSize=n),"page-sizes":[10,20,50,100],background:!0,layout:"prev, pager, next, jumper,->,sizes, total",total:y.total,onSizeChange:de,onCurrentChange:re},null,8,["current-page","page-size","total"])])]),_:1}),l(ee,{modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=n=>V.value=n),title:E.value,width:"600px","before-close":W},{footer:a(()=>[l(s,{onClick:W},{default:a(()=>[...e[20]||(e[20]=[p("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:_e},{default:a(()=>[...e[21]||(e[21]=[p("确定",-1)])]),_:1})]),default:a(()=>[l(T,{model:o,rules:le,ref_key:"formRef",ref:O,"label-width":"100px"},{default:a(()=>[l(u,{label:"题目类型",prop:"type"},{default:a(()=>[l(qe,{modelValue:o.type,"onUpdate:modelValue":e[3]||(e[3]=n=>o.type=n),placeholder:"请选择题目类型",onChange:oe},{default:a(()=>[l(B,{label:"单选题",value:"1"}),l(B,{label:"多选题",value:"2"}),l(B,{label:"判断题",value:"3"}),l(B,{label:"填空题",value:"4"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"问题",prop:"question"},{default:a(()=>[l(i,{modelValue:o.question,"onUpdate:modelValue":e[4]||(e[4]=n=>o.question=n),type:"textarea",rows:3,placeholder:"请输入问题内容"},null,8,["modelValue"])]),_:1}),o.type==="1"||o.type==="2"?(r(),v(L,{key:0},[(r(!0),v(L,null,F(w.value,(n,_)=>(r(),b(u,{key:n.id,label:_===0?"选择题选项":"",prop:"questionOption"},{default:a(()=>[l(i,{modelValue:n.value,"onUpdate:modelValue":S=>n.value=S,placeholder:"请输入选项内容"},{append:a(()=>[w.value.length>1&&_!==0?(r(),b(s,{key:0,icon:"Minus",onClick:S=>ie(n.id)},null,8,["onClick"])):z("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128)),l(u,null,{default:a(()=>[l(s,{type:"primary",icon:"Plus",onClick:ne},{default:a(()=>[...e[17]||(e[17]=[p(" 添加选项 ",-1)])]),_:1})]),_:1})],64)):z("",!0),o.type==="1"||o.type==="2"?(r(),b(u,{key:1,label:"答案",prop:"answerType"},{default:a(()=>[l(i,{modelValue:o.answerType,"onUpdate:modelValue":e[5]||(e[5]=n=>o.answerType=n),placeholder:"请输入答案，例如: 1 或 1,2"},null,8,["modelValue"])]),_:1})):o.type==="4"?(r(!0),v(L,{key:2},F(g.value,(n,_)=>(r(),b(u,{key:n.id,label:_===0?"答案":"",prop:"answerType"},{default:a(()=>[l(i,{modelValue:n.value,"onUpdate:modelValue":S=>n.value=S,placeholder:"请输入答案内容"},{append:a(()=>[g.value.length>1&&_!==0?(r(),b(s,{key:0,icon:"Minus",onClick:S=>ue(n.id)},null,8,["onClick"])):z("",!0),_===g.value.length-1?(r(),b(s,{key:1,icon:"Plus",onClick:se})):z("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128)):o.type==="3"?(r(),b(u,{key:3,label:"答案",prop:"answerType"},{default:a(()=>[l(ke,{modelValue:o.answerType,"onUpdate:modelValue":e[6]||(e[6]=n=>o.answerType=n)},{default:a(()=>[l(Y,{label:"1"},{default:a(()=>[...e[18]||(e[18]=[p("正确",-1)])]),_:1}),l(Y,{label:"2"},{default:a(()=>[...e[19]||(e[19]=[p("错误",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):(r(),b(u,{key:4,label:"答案",prop:"answerType"},{default:a(()=>[l(i,{modelValue:o.answerType,"onUpdate:modelValue":e[7]||(e[7]=n=>o.answerType=n),placeholder:"请输入答案内容"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(ee,{modelValue:P.value,"onUpdate:modelValue":e[9]||(e[9]=n=>P.value=n),title:"题目详情",width:"600px","before-close":Z},{footer:a(()=>[l(s,{onClick:Z},{default:a(()=>[...e[23]||(e[23]=[p("关闭",-1)])]),_:1})]),default:a(()=>[Ne((r(),b(j,{shadow:"hover"},{header:a(()=>[...e[22]||(e[22]=[k("div",{class:"card-header"},[k("span",null,"题目基本信息")],-1)])]),default:a(()=>[l(Ve,{border:"",column:"1"},{default:a(()=>[l(D,{label:"题目类型"},{default:a(()=>[p(h(Q(d.value.type)),1)]),_:1}),l(D,{label:"题目内容"},{default:a(()=>[p(h(d.value.question),1)]),_:1}),d.value.questionOption&&d.value.type!=="4"&&d.value.type!=="3"?(r(),b(D,{key:0,label:"选择题选项"},{default:a(()=>[k("div",{innerHTML:d.value.questionOption.replace(/,/g,"<br/>")},null,8,Re)]),_:1})):z("",!0),l(D,{label:"答案"},{default:a(()=>[d.value.type==="4"?(r(),v("div",$e,[k("div",{innerHTML:(d.value.answerType||"").replace(/\n/g,"<br/>")},null,8,je)])):d.value.type==="3"?(r(),v("div",Ae,[d.value.answerType==="1"?(r(),v("span",Fe,"正确")):d.value.answerType==="2"?(r(),v("span",He,"错误")):(r(),v("span",Je,h(d.value.answerType),1))])):d.value.questionOption&&!isNaN(Number(d.value.answerType))?(r(),v("div",Ie,[(r(!0),v(L,null,F(d.value.questionOption.split(`
`),(n,_)=>(r(),v("div",{key:_},[_+1==Number(d.value.answerType)?(r(),v("span",Ke,h(n),1)):z("",!0)]))),128))])):(r(),v("div",Qe,h(d.value.answerType==="1"?"单选答案":d.value.answerType==="2"?"多选答案":"其他"),1))]),_:1}),l(D,{label:"更新人"},{default:a(()=>[p(h(d.value.updateName),1)]),_:1}),l(D,{label:"更新时间"},{default:a(()=>[p(h(d.value.updateTime),1)]),_:1})]),_:1})]),_:1})),[[Oe,$.value]])]),_:1},8,["modelValue"])])}}}),Xe=Pe(Ge,[["__scopeId","data-v-c80748bc"]]);export{Xe as default};
